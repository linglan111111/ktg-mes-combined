(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-39019a08","chunk-1106d0ed"],{"29cf":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.showFlag?r("el-dialog",{attrs:{title:"设备选择",visible:e.showFlag,modal:!1,width:"80%",center:""},on:{"update:visible":function(t){e.showFlag=t}}},[r("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,size:"small",inline:!0,"label-width":"68px"}},[r("el-form-item",{attrs:{label:"计划编号",prop:"planCode"}},[r("el-input",{attrs:{placeholder:"请输入计划编号",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.planCode,callback:function(t){e.$set(e.queryParams,"planCode",t)},expression:"queryParams.planCode"}})],1),r("el-form-item",{attrs:{label:"计划名称",prop:"planName"}},[r("el-input",{attrs:{placeholder:"请输入计划名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.planName,callback:function(t){e.$set(e.queryParams,"planName",t)},expression:"queryParams.planName"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),r("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.checkplanList},on:{"current-change":e.handleCurrent,"row-dblclick":e.handleRowDbClick}},[r("el-table-column",{attrs:{width:"55",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-radio",{attrs:{label:t.row.planId},on:{change:function(r){return e.handleRowChange(t.row)}},model:{value:e.selectedPlanId,callback:function(t){e.selectedPlanId=t},expression:"selectedPlanId"}},[e._v(e._s(""))])]}}],null,!1,3343453267)}),r("el-table-column",{attrs:{label:"计划编码",align:"center",prop:"planCode"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:checkplan:query"],expression:"['mes:dv:checkplan:query']"}],attrs:{type:"text"},on:{click:function(r){return e.handleView(t.row)}}},[e._v(e._s(t.row.planCode))])]}}],null,!1,1529519676)}),r("el-table-column",{attrs:{label:"计划名称",align:"center",width:"200px",prop:"planName"}}),r("el-table-column",{attrs:{label:"计划类型",align:"center",width:"120px",prop:"planType"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("dict-tag",{attrs:{options:e.dict.type.dv_plan_type,value:t.row.planType}})]}}],null,!1,1542401585)}),r("el-table-column",{attrs:{label:"开始日期",align:"center",prop:"startDate",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e.parseTime(t.row.startDate,"{y}-{m}-{d}")))])]}}],null,!1,3859946761)}),r("el-table-column",{attrs:{label:"结束日期",align:"center",prop:"endDate",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e.parseTime(t.row.endDate,"{y}-{m}-{d}")))])]}}],null,!1,4090872870)}),r("el-table-column",{attrs:{label:"频率",align:"center",prop:"cycleType",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.cycleCount)),r("dict-tag",{attrs:{options:e.dict.type.mes_cycle_type,value:t.row.cycleType}})]}}],null,!1,1922333513)}),r("el-table-column",{attrs:{label:"状态",align:"center",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("dict-tag",{attrs:{options:e.dict.type.mes_order_status,value:t.row.status}})]}}],null,!1,2866832246)}),r("el-table-column",{attrs:{label:"操作",align:"center",width:"130px","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return["PREPARE"==t.row.status?r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:checkplan:edit"],expression:"['mes:dv:checkplan:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(r){return e.handleUpdate(t.row)}}},[e._v("修改")]):e._e(),"PREPARE"==t.row.status?r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:checkplan:remove"],expression:"['mes:dv:checkplan:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(r){return e.handleDelete(t.row)}}},[e._v("删除")]):e._e(),"FINISHED"==t.row.status?r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:checkplan:edit"],expression:"['mes:dv:checkplan:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(r){return e.handleUpdate(t.row)}}},[e._v("停用")]):e._e()]}}],null,!1,594271702)})],1),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:e.confirmSelect}},[e._v("确 定")]),r("el-button",{on:{click:function(t){e.showFlag=!1}}},[e._v("取 消")])],1)],1):e._e()},a=[],l=r("63b7"),s={name:"CheckplanSelect",dicts:["mes_cycle_type","mes_order_status","dv_plan_type"],props:{planType:{type:String,default:"CHECK"}},data(){return{showFlag:!1,loading:!0,selectedPlanId:void 0,selectedRow:void 0,single:!0,multiple:!0,showSearch:!0,total:0,checkplanList:[],title:"",open:!1,queryParams:{pageNum:1,pageSize:10,planCode:null,planName:null,planType:this.planType,startDate:null,endDate:null,cycleType:null,cycleCount:null,status:"FINISHED"}}},created(){this.getList()},methods:{getList(){this.loading=!0,Object(l["e"])(this.queryParams).then(e=>{this.checkplanList=e.rows,this.total=e.total,this.loading=!1})},handleQuery(){this.queryParams.pageNum=1,this.getList()},resetQuery(){this.resetForm("queryForm"),this.handleQuery()},handleCurrent(e){e&&(this.selectedRow=e)},handleRowDbClick(e){e&&(this.selectedRow=e,this.$emit("onSelected",this.selectedRow),this.showFlag=!1)},handleRowChange(e){e&&(this.selectedRow=e)},confirmSelect(){null!=this.selectedPlanId&&0!=this.selectedPlanId?(this.$emit("onSelected",this.selectedRow),this.showFlag=!1):this.$notify({title:"提示",type:"warning",message:"请至少选择一条数据!"})}}},o=s,c=r("2877"),i=Object(c["a"])(o,n,a,!1,null,null,null);t["a"]=i.exports},"2d80":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},["view"!==e.optType?r("el-row",{staticClass:"mb8",attrs:{gutter:10}},[r("el-col",{attrs:{span:1.5}},[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["dv:checkrecordline:add"],expression:"['dv:checkrecordline:add']"}],attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:e.handleAdd}},[e._v("新增")])],1),r("el-col",{attrs:{span:1.5}},[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["dv:checkrecordline:edit"],expression:"['dv:checkrecordline:edit']"}],attrs:{type:"success",plain:"",icon:"el-icon-edit",size:"mini",disabled:e.single},on:{click:e.handleUpdate}},[e._v("修改")])],1),r("el-col",{attrs:{span:1.5}},[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["dv:checkrecordline:remove"],expression:"['dv:checkrecordline:remove']"}],attrs:{type:"danger",plain:"",icon:"el-icon-delete",size:"mini",disabled:e.multiple},on:{click:e.handleDelete}},[e._v("删除")])],1),r("right-toolbar",{attrs:{showSearch:e.showSearch},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.getList}})],1):e._e(),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.checkrecordlineList},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),r("el-table-column",{attrs:{label:"项目名称",align:"center",prop:"subjectName"}}),r("el-table-column",{attrs:{label:"检查内容",align:"center",prop:"subjectContent","show-overflow-tooltip":!0}}),r("el-table-column",{attrs:{label:"标准",align:"center",prop:"subjectStandard"}}),r("el-table-column",{attrs:{label:"点检结果",align:"center",prop:"checkStatus"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("dict-tag",{attrs:{options:e.dict.type.dv_cm_result_status,value:t.row.checkStatus}})]}}])}),r("el-table-column",{attrs:{label:"异常描述",align:"center",prop:"checkResult","show-overflow-tooltip":!0}}),"view"!==e.optType?r("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["dv:checkrecordline:edit"],expression:"['dv:checkrecordline:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(r){return e.handleUpdate(t.row)}}},[e._v("修改")]),r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["dv:checkrecordline:remove"],expression:"['dv:checkrecordline:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(r){return e.handleDelete(t.row)}}},[e._v("删除")])]}}],null,!1,4195100810)}):e._e()],1),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),r("el-dialog",{attrs:{title:e.title,visible:e.open,width:"960px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"项目名称",prop:"subjectName"}},[r("el-input",{attrs:{placeholder:"请选择检查项目"},model:{value:e.form.subjectName,callback:function(t){e.$set(e.form,"subjectName",t)},expression:"form.subjectName"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSelectSubject},slot:"append"})],1)],1),r("DvSubjectSelect",{ref:"subjectSelect",attrs:{subjectType:"CHECK"},on:{onSelected:e.onSubjectSelected}})],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"标准",prop:"subjectStandard"}},[r("el-input",{attrs:{placeholder:"请输入标准"},model:{value:e.form.subjectStandard,callback:function(t){e.$set(e.form,"subjectStandard",t)},expression:"form.subjectStandard"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"项目内容"}},[r("el-input",{attrs:{type:"textarea","min-height":192},model:{value:e.form.subjectContent,callback:function(t){e.$set(e.form,"subjectContent",t)},expression:"form.subjectContent"}})],1)],1)],1),r("el-form-item",{attrs:{label:"点检结果"}},[r("el-radio-group",{model:{value:e.form.checkStatus,callback:function(t){e.$set(e.form,"checkStatus",t)},expression:"form.checkStatus"}},[r("el-radio",{attrs:{label:"Y"}},[e._v("正常")]),r("el-radio",{attrs:{label:"N"}},[e._v("异常")])],1)],1),"N"===e.form.checkStatus?r("el-form-item",{attrs:{label:"异常描述",prop:"checkResult"}},[r("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.form.checkResult,callback:function(t){e.$set(e.form,"checkResult",t)},expression:"form.checkResult"}})],1):e._e()],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),r("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},a=[],l=(r("e9f5"),r("ab43"),r("b775"));function s(e){return Object(l["a"])({url:"/mes/dv/checkrecordline/list",method:"get",params:e})}function o(e){return Object(l["a"])({url:"/mes/dv/checkrecordline/"+e,method:"get"})}function c(e){return Object(l["a"])({url:"/mes/dv/checkrecordline",method:"post",data:e})}function i(e){return Object(l["a"])({url:"/mes/dv/checkrecordline",method:"put",data:e})}function u(e){return Object(l["a"])({url:"/mes/dv/checkrecordline/"+e,method:"delete"})}var d=r("8063"),m={name:"Checkrecordline",props:{optType:null,recordId:null},dicts:["dv_cm_result_status"],components:{DvSubjectSelect:d["a"]},data(){return{loading:!0,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,checkrecordlineList:[],title:"",open:!1,queryParams:{pageNum:1,pageSize:10,recordId:this.recordId,subjectId:null,subjectCode:null,subjectName:null,subjectType:null,subjectContent:null,subjectStandard:null,checkStatus:null,checkResult:null},form:{},rules:{recordId:[{required:!0,message:"计划ID不能为空",trigger:"blur"}],subjectId:[{required:!0,message:"项目ID不能为空",trigger:"blur"}],subjectCode:[{required:!0,message:"项目编码不能为空",trigger:"blur"}],subjectContent:[{required:!0,message:"项目内容不能为空",trigger:"blur"}],checkStatus:[{required:!0,message:"点检结果不能为空",trigger:"blur"}]}}},created(){this.getList()},methods:{getList(){this.loading=!0,s(this.queryParams).then(e=>{this.checkrecordlineList=e.rows,this.total=e.total,this.loading=!1})},cancel(){this.open=!1,this.reset()},reset(){this.form={lineId:null,recordId:this.recordId,subjectId:null,subjectCode:null,subjectName:null,subjectType:null,subjectContent:null,subjectStandard:null,checkStatus:"Y",checkResult:null,attr1:null,attr2:null,attr3:null,attr4:null,createBy:null,createTime:null,updateBy:null,updateTime:null},this.resetForm("form")},handleQuery(){this.queryParams.pageNum=1,this.getList()},resetQuery(){this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange(e){this.ids=e.map(e=>e.lineId),this.single=1!==e.length,this.multiple=!e.length},handleAdd(){this.reset(),this.open=!0,this.title="添加设备点检记录行"},handleUpdate(e){this.reset();const t=e.lineId||this.ids;o(t).then(e=>{this.form=e.data,this.open=!0,this.title="修改设备点检记录行"})},submitForm(){this.$refs["form"].validate(e=>{e&&(null!=this.form.lineId?i(this.form).then(e=>{this.$modal.msgSuccess("修改成功"),this.open=!1,this.getList()}):c(this.form).then(e=>{this.$modal.msgSuccess("新增成功"),this.open=!1,this.getList()}))})},handleDelete(e){const t=e.lineId||this.ids;this.$modal.confirm('是否确认删除设备点检记录行编号为"'+t+'"的数据项？').then((function(){return u(t)})).then(()=>{this.getList(),this.$modal.msgSuccess("删除成功")}).catch(()=>{})},handleSelectSubject(){this.$refs.subjectSelect.showFlag=!0},onSubjectSelected(e){e&&(this.form.subjectId=e.subjectId,this.form.subjectCode=e.subjectCode,this.form.subjectName=e.subjectName,this.form.subjectType=e.subjectType,this.form.subjectContent=e.subjectContent,this.form.subjectStandard=e.subjectStandard)}}},h=m,p=r("2877"),f=Object(p["a"])(h,n,a,!1,null,null,null);t["default"]=f.exports},"63b7":function(e,t,r){"use strict";r.d(t,"e",(function(){return a})),r.d(t,"d",(function(){return l})),r.d(t,"a",(function(){return s})),r.d(t,"f",(function(){return o})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return i}));var n=r("b775");function a(e){return Object(n["a"])({url:"/mes/dv/checkplan/list",method:"get",params:e})}function l(e){return Object(n["a"])({url:"/mes/dv/checkplan/"+e,method:"get"})}function s(e){return Object(n["a"])({url:"/mes/dv/checkplan",method:"post",data:e})}function o(e){return Object(n["a"])({url:"/mes/dv/checkplan",method:"put",data:e})}function c(e){return Object(n["a"])({url:"/mes/dv/checkplan/"+e,method:"delete"})}function i(e){return Object(n["a"])({url:"/mes/dv/checkplan/getCheckPlan",method:"get",params:e})}},"66e4":function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return l})),r.d(t,"a",(function(){return s})),r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return c}));var n=r("b775");function a(e){return Object(n["a"])({url:"/mes/dv/machinery/list",method:"get",params:e})}function l(e){return Object(n["a"])({url:"/mes/dv/machinery/"+e,method:"get"})}function s(e){return Object(n["a"])({url:"/mes/dv/machinery",method:"post",data:e})}function o(e){return Object(n["a"])({url:"/mes/dv/machinery",method:"put",data:e})}function c(e){return Object(n["a"])({url:"/mes/dv/machinery/"+e,method:"delete"})}},"6b7a":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,size:"small",inline:!0,"label-width":"68px"}},[r("el-form-item",{attrs:{label:"计划编码",prop:"planCode"}},[r("el-input",{attrs:{placeholder:"请输入计划编码",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.planCode,callback:function(t){e.$set(e.queryParams,"planCode",t)},expression:"queryParams.planCode"}})],1),r("el-form-item",{attrs:{label:"计划名称",prop:"planName"}},[r("el-input",{attrs:{placeholder:"请输入计划名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.planName,callback:function(t){e.$set(e.queryParams,"planName",t)},expression:"queryParams.planName"}})],1),r("el-form-item",{attrs:{label:"设备编码",prop:"machineryCode"}},[r("el-input",{attrs:{placeholder:"请输入设备编码",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.machineryCode,callback:function(t){e.$set(e.queryParams,"machineryCode",t)},expression:"queryParams.machineryCode"}})],1),r("el-form-item",{attrs:{label:"设备名称",prop:"machineryName"}},[r("el-input",{attrs:{placeholder:"请输入设备名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.machineryName,callback:function(t){e.$set(e.queryParams,"machineryName",t)},expression:"queryParams.machineryName"}})],1),r("el-form-item",{attrs:{label:"点检时间",prop:"checkTime"}},[r("el-date-picker",{attrs:{clearable:"",type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择点检时间"},model:{value:e.queryParams.checkTime,callback:function(t){e.$set(e.queryParams,"checkTime",t)},expression:"queryParams.checkTime"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),r("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),r("el-row",{staticClass:"mb8",attrs:{gutter:10}},[r("el-col",{attrs:{span:1.5}},[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:checkrecord:add"],expression:"['mes:dv:checkrecord:add']"}],attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:e.handleAdd}},[e._v("新增")])],1),r("el-col",{attrs:{span:1.5}},[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:checkrecord:edit"],expression:"['mes:dv:checkrecord:edit']"}],attrs:{type:"success",plain:"",icon:"el-icon-edit",size:"mini",disabled:e.single},on:{click:e.handleUpdate}},[e._v("修改")])],1),r("el-col",{attrs:{span:1.5}},[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:checkrecord:remove"],expression:"['mes:dv:checkrecord:remove']"}],attrs:{type:"danger",plain:"",icon:"el-icon-delete",size:"mini",disabled:e.multiple},on:{click:e.handleDelete}},[e._v("删除")])],1),r("right-toolbar",{attrs:{showSearch:e.showSearch},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.getList}})],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.checkrecordList},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),r("el-table-column",{attrs:{label:"设备编码",align:"center",prop:"machineryCode"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:checkrecord:query"],expression:"['mes:dv:checkrecord:query']"}],attrs:{type:"text"},on:{click:function(r){return e.handleView(t.row)}}},[e._v(e._s(t.row.machineryCode))])]}}])}),r("el-table-column",{attrs:{label:"设备名称",align:"center",prop:"machineryName"}}),r("el-table-column",{attrs:{label:"品牌",align:"center",prop:"machineryBrand"}}),r("el-table-column",{attrs:{label:"规格型号",align:"center",prop:"machinerySpec"}}),r("el-table-column",{attrs:{label:"计划编码",align:"center",prop:"planCode"}}),r("el-table-column",{attrs:{label:"计划名称",align:"center",prop:"planName"}}),r("el-table-column",{attrs:{label:"点检人",align:"center",prop:"nickName"}}),r("el-table-column",{attrs:{label:"点检时间",align:"center",prop:"checkTime",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e.parseTime(t.row.checkTime,"{y}-{m}-{d} {h}:{i}:{s}")))])]}}])}),r("el-table-column",{attrs:{label:"状态",align:"center",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("dict-tag",{attrs:{options:e.dict.type.mes_order_status,value:t.row.status}})]}}])}),r("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return["PREPARE"==t.row.status?r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:checkrecord:edit"],expression:"['mes:dv:checkrecord:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(r){return e.handleUpdate(t.row)}}},[e._v("修改")]):e._e(),"PREPARE"==t.row.status?r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:checkrecord:remove"],expression:"['mes:dv:checkrecord:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(r){return e.handleDelete(t.row)}}},[e._v("删除")]):e._e()]}}])})],1),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),r("el-dialog",{attrs:{title:e.title,visible:e.open,width:"960px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"设备编码",prop:"machineryCode"}},[r("el-input",{attrs:{placeholder:"请选择设备"},model:{value:e.form.machineryCode,callback:function(t){e.$set(e.form,"machineryCode",t)},expression:"form.machineryCode"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSelectMachinery},slot:"append"})],1)],1),r("MachinerySelectSingle",{ref:"machinerySelect",on:{onSelected:e.onMachineryAdd}})],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"设备名称",prop:"machineryName"}},[r("el-input",{attrs:{readonly:"readonly",placeholder:"请选择设备"},model:{value:e.form.machineryName,callback:function(t){e.$set(e.form,"machineryName",t)},expression:"form.machineryName"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"品牌",prop:"machineryBrand"}},[r("el-input",{attrs:{readonly:"readonly",placeholder:"请选择设备"},model:{value:e.form.machineryBrand,callback:function(t){e.$set(e.form,"machineryBrand",t)},expression:"form.machineryBrand"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"规格型号",prop:"machinerySpec"}},[r("el-input",{attrs:{readonly:"readonly",type:"textarea",placeholder:"请选择设备"},model:{value:e.form.machinerySpec,callback:function(t){e.$set(e.form,"machinerySpec",t)},expression:"form.machinerySpec"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"点检计划",prop:"planName"}},[r("el-input",{attrs:{placeholder:"请选择设备点检计划"},model:{value:e.form.planName,callback:function(t){e.$set(e.form,"planName",t)},expression:"form.planName"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSelectPlan},slot:"append"})],1)],1),r("CheckplanSelect",{ref:"checkplanSelect",attrs:{planType:"CHECK"},on:{onSelected:e.onPlanAdd}})],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"点检人",prop:"nickName"}},[r("el-input",{attrs:{placeholder:"请选择点检人"},model:{value:e.form.nickName,callback:function(t){e.$set(e.form,"nickName",t)},expression:"form.nickName"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleUserSelect},slot:"append"})],1)],1),r("UserSingleSelect",{ref:"userSelect",on:{onSelected:e.onUserSelected}})],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"点检时间",prop:"checkTime"}},[r("el-date-picker",{attrs:{clearable:"",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择点检时间"},model:{value:e.form.checkTime,callback:function(t){e.$set(e.form,"checkTime",t)},expression:"form.checkTime"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1)],1),null!=e.form.recordId?r("el-divider",{attrs:{"content-position":"center"}},[e._v("点检项目")]):e._e(),null!=e.form.recordId?r("el-card",{staticClass:"box-card",attrs:{shadow:"always"}},[r("CheckRecordLine",{ref:"checkRecordLine",attrs:{optType:e.optType,recordId:e.form.recordId}})],1):e._e(),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["view"==e.optType||"PREPARE"!=e.form.status?r("el-button",{attrs:{type:"primary"},on:{click:e.cancel}},[e._v("返 回")]):e._e(),"view"!==e.optType&&"PREPARE"==e.form.status?r("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("保 存")]):e._e(),"view"!==e.optType&&"PREPARE"==e.form.status?r("el-button",{attrs:{type:"success"},on:{click:e.handleFinish}},[e._v("提 交")]):e._e(),r("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},a=[],l=(r("e9f5"),r("ab43"),r("b775"));function s(e){return Object(l["a"])({url:"/mes/dv/checkrecord/list",method:"get",params:e})}function o(e){return Object(l["a"])({url:"/mes/dv/checkrecord/"+e,method:"get"})}function c(e){return Object(l["a"])({url:"/mes/dv/checkrecord",method:"post",data:e})}function i(e){return Object(l["a"])({url:"/mes/dv/checkrecord",method:"put",data:e})}function u(e){return Object(l["a"])({url:"/mes/dv/checkrecord/"+e,method:"delete"})}var d=r("7dc7"),m=r("29cf"),h=r("2d80"),p=r("8198"),f={name:"Checkrecord",dicts:["mes_order_status"],components:{MachinerySelectSingle:d["a"],CheckplanSelect:m["a"],CheckRecordLine:h["default"],UserSingleSelect:p["a"]},data(){return{optType:null,loading:!0,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,checkrecordList:[],title:"",open:!1,queryParams:{pageNum:1,pageSize:10,planId:null,planCode:null,planName:null,planType:null,machineryId:null,machineryCode:null,machineryName:null,machineryBrand:null,machinerySpec:null,checkTime:null,nickName:null,status:null},form:{},rules:{machineryId:[{required:!0,message:"设备ID不能为空",trigger:"blur"}],machineryCode:[{required:!0,message:"设备编码不能为空",trigger:"blur"}],checkTime:[{required:!0,message:"点检时间不能为空",trigger:"blur"}]}}},created(){this.getList()},methods:{getList(){this.loading=!0,s(this.queryParams).then(e=>{this.checkrecordList=e.rows,this.total=e.total,this.loading=!1})},cancel(){this.open=!1,this.reset()},reset(){this.form={recordId:null,planId:null,planCode:null,planName:null,planType:null,machineryId:null,machineryCode:null,machineryName:null,machineryBrand:null,machinerySpec:null,checkTime:this.formatDate(new Date,"yyyy-MM-dd HH:mm:ss"),status:"PREPARE",remark:null,attr1:null,attr2:null,attr3:null,attr4:null,createBy:null,createTime:null,updateBy:null,updateTime:null},this.form.userId=this.$store.state.user.id,this.form.nickName=this.$store.state.user.nick,this.form.userName=this.$store.state.user.name},created(){this.getList()},handleQuery(){this.queryParams.pageNum=1,this.getList()},resetQuery(){this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange(e){this.ids=e.map(e=>e.recordId),this.single=1!==e.length,this.multiple=!e.length},handleAdd(){this.reset(),this.open=!0,this.title="添加设备点检记录",this.optType="add"},handleUpdate(e){this.reset();const t=e.recordId||this.ids;o(t).then(e=>{this.form=e.data,this.open=!0,this.title="修改设备点检记录",this.optType="edit"})},handleView(e){this.reset();const t=e.recordId||this.ids;o(t).then(e=>{this.form=e.data,this.open=!0,this.title="查看设备点检记录",this.optType="view"})},submitForm(){this.$refs["form"].validate(e=>{e&&(null!=this.form.recordId?i(this.form).then(e=>{this.$modal.msgSuccess("修改成功"),this.open=!1,this.getList()}):c(this.form).then(e=>{this.$modal.msgSuccess("新增成功"),this.open=!1,this.getList()}))})},handleFinish(){null!=this.form.recordId&&"PREPARE"==this.form.status&&(this.form.status="FINISHED",i(this.form).then(e=>{this.$modal.msgSuccess("已提交"),this.open=!1,this.getList()},e=>{this.form.status="PREPARE"}))},handleDelete(e){const t=e.recordId||this.ids;this.$modal.confirm('是否确认删除设备点检记录编号为"'+t+'"的数据项？').then((function(){return u(t)})).then(()=>{this.getList(),this.$modal.msgSuccess("删除成功")}).catch(()=>{})},handleSelectMachinery(){this.$refs.machinerySelect.showFlag=!0},onMachineryAdd(e){null!=e&&void 0!=e&&(this.form.machineryId=e.machineryId,this.form.machineryCode=e.machineryCode,this.form.machineryName=e.machineryName,this.form.machineryBrand=e.machineryBrand,this.form.machinerySpec=e.machinerySpec)},handleSelectPlan(){this.$refs.checkplanSelect.showFlag=!0},onPlanAdd(e){null!=e&&void 0!=e&&(this.form.planId=e.planId,this.form.planCode=e.planCode,this.form.planName=e.planName,this.form.planType=e.planType)},handleUserSelect(){this.$refs.userSelect.showFlag=!0},onUserSelected(e){this.form.userId=e.userId,this.form.nickName=e.nickName,this.form.userName=e.userName},handleExport(){this.download("dv/checkrecord/export",{...this.queryParams},`checkrecord_${(new Date).getTime()}.xlsx`)}}},y=f,b=r("2877"),v=Object(b["a"])(y,n,a,!1,null,null,null);t["default"]=v.exports},"995c":function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return l})),r.d(t,"a",(function(){return s})),r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return c}));var n=r("b775");function a(e){return Object(n["a"])({url:"/mes/dv/dvsubject/list",method:"get",params:e})}function l(e){return Object(n["a"])({url:"/mes/dv/dvsubject/"+e,method:"get"})}function s(e){return Object(n["a"])({url:"/mes/dv/dvsubject",method:"post",data:e})}function o(e){return Object(n["a"])({url:"/mes/dv/dvsubject",method:"put",data:e})}function c(e){return Object(n["a"])({url:"/mes/dv/dvsubject/"+e,method:"delete"})}},a15c:function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return l})),r.d(t,"a",(function(){return s})),r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return c}));var n=r("b775");function a(e){return Object(n["a"])({url:"/mes/dv/machinerytype/list",method:"get",params:e})}function l(e){return Object(n["a"])({url:"/mes/dv/machinerytype/"+e,method:"get"})}function s(e){return Object(n["a"])({url:"/mes/dv/machinerytype",method:"post",data:e})}function o(e){return Object(n["a"])({url:"/mes/dv/machinerytype",method:"put",data:e})}function c(e){return Object(n["a"])({url:"/mes/dv/machinerytype/"+e,method:"delete"})}},c0c7:function(e,t,r){"use strict";r.d(t,"g",(function(){return l})),r.d(t,"e",(function(){return s})),r.d(t,"a",(function(){return o})),r.d(t,"j",(function(){return c})),r.d(t,"c",(function(){return i})),r.d(t,"h",(function(){return u})),r.d(t,"b",(function(){return d})),r.d(t,"f",(function(){return m})),r.d(t,"k",(function(){return h})),r.d(t,"l",(function(){return p})),r.d(t,"m",(function(){return f})),r.d(t,"d",(function(){return y})),r.d(t,"i",(function(){return b}));var n=r("b775"),a=r("c38a");function l(e){return Object(n["a"])({url:"/system/user/list",method:"get",params:e})}function s(e){return Object(n["a"])({url:"/system/user/"+Object(a["e"])(e),method:"get"})}function o(e){return Object(n["a"])({url:"/system/user",method:"post",data:e})}function c(e){return Object(n["a"])({url:"/system/user",method:"put",data:e})}function i(e){return Object(n["a"])({url:"/system/user/"+e,method:"delete"})}function u(e,t){const r={userId:e,password:t};return Object(n["a"])({url:"/system/user/resetPwd",method:"put",data:r})}function d(e,t){const r={userId:e,status:t};return Object(n["a"])({url:"/system/user/changeStatus",method:"put",data:r})}function m(){return Object(n["a"])({url:"/system/user/profile",method:"get"})}function h(e){return Object(n["a"])({url:"/system/user/profile",method:"put",data:e})}function p(e,t){const r={oldPassword:e,newPassword:t};return Object(n["a"])({url:"/system/user/profile/updatePwd",method:"put",params:r})}function f(e){return Object(n["a"])({url:"/system/user/profile/avatar",method:"post",data:e})}function y(e){return Object(n["a"])({url:"/system/user/authRole/"+e,method:"get"})}function b(e){return Object(n["a"])({url:"/system/user/authRole",method:"put",params:e})}},dfb9:function(e,t,r){"use strict";r.d(t,"e",(function(){return a})),r.d(t,"d",(function(){return l})),r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return o})),r.d(t,"f",(function(){return c})),r.d(t,"b",(function(){return i}));var n=r("b775");function a(e){return Object(n["a"])({url:"/mes/md/workshop/list",method:"get",params:e})}function l(){return Object(n["a"])({url:"/mes/md/workshop/listAll",method:"get"})}function s(e){return Object(n["a"])({url:"/mes/md/workshop/"+e,method:"get"})}function o(e){return Object(n["a"])({url:"/mes/md/workshop",method:"post",data:e})}function c(e){return Object(n["a"])({url:"/mes/md/workshop",method:"put",data:e})}function i(e){return Object(n["a"])({url:"/mes/md/workshop/"+e,method:"delete"})}},fcb7:function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"e",(function(){return l})),r.d(t,"c",(function(){return s})),r.d(t,"g",(function(){return o})),r.d(t,"f",(function(){return c})),r.d(t,"a",(function(){return i})),r.d(t,"h",(function(){return u})),r.d(t,"b",(function(){return d}));var n=r("b775");function a(e){return Object(n["a"])({url:"/system/dept/list",method:"get",params:e})}function l(e){return Object(n["a"])({url:"/system/dept/list/exclude/"+e,method:"get"})}function s(e){return Object(n["a"])({url:"/system/dept/"+e,method:"get"})}function o(){return Object(n["a"])({url:"/system/dept/treeselect",method:"get"})}function c(e){return Object(n["a"])({url:"/system/dept/roleDeptTreeselect/"+e,method:"get"})}function i(e){return Object(n["a"])({url:"/system/dept",method:"post",data:e})}function u(e){return Object(n["a"])({url:"/system/dept",method:"put",data:e})}function d(e){return Object(n["a"])({url:"/system/dept/"+e,method:"delete"})}}}]);