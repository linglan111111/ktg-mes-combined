(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2173b5"],{c69e:function(e,t,l){"use strict";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"app-container"},[l("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[l("el-row",[l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"检验单编号",prop:"rqcCode"}},[l("el-input",{attrs:{placeholder:"请输入检验单编号"},model:{value:e.form.rqcCode,callback:function(t){e.$set(e.form,"rqcCode",t)},expression:"form.rqcCode"}})],1)],1),l("el-col",{attrs:{span:4}},[l("el-form-item",{attrs:{"label-width":"80"}},["view"!=e.optType&&"PREPARE"==e.form.status?l("el-switch",{attrs:{"active-color":"#13ce66","active-text":"自动生成"},on:{change:function(t){return e.handleAutoGenChange(e.autoGenFlag)}},model:{value:e.autoGenFlag,callback:function(t){e.autoGenFlag=t},expression:"autoGenFlag"}}):e._e()],1)],1),l("el-col",{attrs:{span:12}},[l("el-form-item",{attrs:{label:"检验单名称",prop:"rqcName"}},[l("el-input",{attrs:{placeholder:"请输入检验单名称"},model:{value:e.form.rqcName,callback:function(t){e.$set(e.form,"rqcName",t)},expression:"form.rqcName"}})],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"检验类型",prop:"rqcType"}},[l("el-select",{attrs:{placeholder:"请选择检验类型"},model:{value:e.form.rqcType,callback:function(t){e.$set(e.form,"rqcType",t)},expression:"form.rqcType"}},e._l(e.dict.type.mes_rqc_type,(function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"来源单据类型",prop:"sourceDocType"}},[l("el-select",{attrs:{disabled:""},model:{value:e.form.sourceDocType,callback:function(t){e.$set(e.form,"sourceDocType",t)},expression:"form.sourceDocType"}},e._l(e.dict.type.mes_source_doc_type,(function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"来源单据编号",prop:"sourceDocCode"}},[l("el-input",{attrs:{readonly:"readonly"},model:{value:e.form.sourceDocCode,callback:function(t){e.$set(e.form,"sourceDocCode",t)},expression:"form.sourceDocCode"}})],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"物资编码",prop:"itemCode"}},[null==e.form.rqcId?l("el-input",{attrs:{readonly:"",placeholder:"请选择物资"},model:{value:e.form.itemCode,callback:function(t){e.$set(e.form,"itemCode",t)},expression:"form.itemCode"}},[l("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSelectProduct},slot:"append"})],1):l("el-input",{model:{value:e.form.itemCode,callback:function(t){e.$set(e.form,"itemCode",t)},expression:"form.itemCode"}})],1),l("ItemSelect",{ref:"itemSelect",on:{onSelected:e.onItemSelected}})],1),l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"物资名称",prop:"itemName"}},[l("el-input",{attrs:{placeholder:"请选择物资"},model:{value:e.form.itemName,callback:function(t){e.$set(e.form,"itemName",t)},expression:"form.itemName"}})],1)],1),l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"单位",prop:"unitName"}},[l("el-input",{attrs:{placeholder:"请选择物资"},model:{value:e.form.unitName,callback:function(t){e.$set(e.form,"unitName",t)},expression:"form.unitName"}})],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:24}},[l("el-form-item",{attrs:{label:"规格型号",prop:"specification"}},[l("el-input",{attrs:{type:"textarea",placeholder:"请选择物资"},model:{value:e.form.specification,callback:function(t){e.$set(e.form,"specification",t)},expression:"form.specification"}})],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"批次号",prop:"batchCode"}},[l("el-input",{attrs:{placeholder:"请输入批次号"},model:{value:e.form.batchCode,callback:function(t){e.$set(e.form,"batchCode",t)},expression:"form.batchCode"}})],1)],1),l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"检测结果",prop:"checkResult"}},[l("el-select",{attrs:{placeholder:"请选择检测结果"},model:{value:e.form.checkResult,callback:function(t){e.$set(e.form,"checkResult",t)},expression:"form.checkResult"}},e._l(e.dict.type.mes_qc_result,(function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"检测日期",prop:"inspectDate"}},[l("el-date-picker",{attrs:{clearable:"",type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择检测日期"},model:{value:e.form.inspectDate,callback:function(t){e.$set(e.form,"inspectDate",t)},expression:"form.inspectDate"}})],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"检测数量",prop:"quantityCheck"}},[l("el-input-number",{attrs:{min:0,max:99999999,placeholder:"检测数量"},model:{value:e.form.quantityCheck,callback:function(t){e.$set(e.form,"quantityCheck",t)},expression:"form.quantityCheck"}})],1)],1),l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"合格品数量",prop:"quantityQualified"}},[l("el-input-number",{attrs:{min:0,max:99999999,placeholder:"请输入合格品数量"},model:{value:e.form.quantityQualified,callback:function(t){e.$set(e.form,"quantityQualified",t)},expression:"form.quantityQualified"}})],1)],1),l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"不合格数量",prop:"quantityUnqualified"}},[l("el-input-number",{attrs:{min:0,max:99999999,placeholder:"请输入不合格数"},model:{value:e.form.quantityUnqualified,callback:function(t){e.$set(e.form,"quantityUnqualified",t)},expression:"form.quantityUnqualified"}})],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"审核人",prop:"nickName"}},[l("el-input",{attrs:{placeholder:"请选择审核人"},model:{value:e.form.nickName,callback:function(t){e.$set(e.form,"nickName",t)},expression:"form.nickName"}},[l("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleUser2Select},slot:"append"})],1)],1),l("UserSingleSelect",{ref:"user2Select",on:{onSelected:e.onUser2Selected}})],1),l("el-col",{attrs:{span:8}}),l("el-col",{attrs:{span:8}})],1),l("el-row",[l("el-col",{attrs:{span:24}},[l("el-form-item",{attrs:{label:"备注",prop:"remark"}},[l("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1)],1),null!=e.form.rqcId?l("el-tabs",{attrs:{type:"border-card"}},[l("el-tab-pane",{attrs:{label:"检测项"}},[l("RqcLine",{ref:"line",attrs:{rqcId:e.form.rqcId,optType:e.optType}})],1),l("el-tab-pane",{attrs:{label:"检测结果"}},[l("QCResutl",{ref:"qcResult",attrs:{qcId:e.form.rqcId,qcType:"RQC",optType:e.optType}})],1)],1):e._e(),l("el-form",{attrs:{"label-width":"100px"}},[l("el-form-item",{staticStyle:{"text-align":"center","margin-left":"-120px","margin-top":"30px"}},["PREPARE"==e.form.status&&"view"!=e.optType?l("el-button",{attrs:{type:"primary"},on:{click:e.saveForm}},[e._v("保 存")]):e._e(),"PREPARE"==e.form.status&&null!=e.form.rqcId&&"view"!=e.optType?l("el-button",{attrs:{type:"warning"},on:{click:e.handleFinish}},[e._v("完 成")]):e._e(),l("el-button",{on:{click:e.cancel}},[e._v("关 闭")])],1)],1)],1)},r=[],o=l("fcad"),i=l("25fa"),s=l("8198"),n=l("4175"),c=l("1389"),u=l("8171"),m={name:"Rqc",components:{QCResutl:n["default"],RqcLine:c["default"],ItemSelect:i["a"],UserSingleSelect:s["a"]},dicts:["mes_rqc_type","mes_qc_result","mes_source_doc_type","mes_rt_issue_status"],props:{sourceDocId:null,sourceDocCode:null,sourceDocType:null,sourceLineId:null,qcDetailType:null,itemId:null,itemCode:null,itemName:null,specification:null,unitOfMeasure:null,unitName:null,batchId:null,batchCode:null,quantityCheck:null},data(){return{autoGenFlag:!1,optType:"add",form:{},rules:{rqcCode:[{required:!0,message:"检验单编号不能为空",trigger:"blur"}],rqcType:[{required:!0,message:"请选择退料检测类型",trigger:"blur"}],checkResult:[{required:!0,message:"请选择检测结果",trigger:"blur"}],inspectDate:[{required:!0,message:"检测日期不能为空",trigger:"blur"}],nickName:[{required:!0,message:"请选择检测人员",trigger:"blur"}],quantityCheck:[{required:!0,message:"请填写检测数量",trigger:"blur"}],quantityQualified:[{required:!0,message:"请填写合格品数量",trigger:"blur"}],quantityUnqualified:[{required:!0,message:"请填写不良品数量",trigger:"blur"}]}}},created(){this.reset()},methods:{reset(){this.form={rqcId:null,rqcCode:null,rqcName:null,rqcType:this.qcDetailType,templateId:null,sourceDocId:this.sourceDocId,sourceDocType:this.sourceDocType,sourceDocCode:this.sourceDocCode,sourceLineId:this.sourceLineId,itemId:this.itemId,itemCode:this.itemCode,itemName:this.itemName,specification:this.specification,unitOfMeasure:this.unitOfMeasure,unitName:this.unitName,batchId:this.batchId,batchCode:this.batchCode,quantityCheck:this.quantityCheck,quantityUnqualified:0,quantityQualified:0,checkResult:null,inspectDate:new Date,userId:null,userName:null,nickName:null,status:"PREPARE",remark:null,attr1:null,attr2:null,attr3:null,attr4:null,createBy:null,createTime:null,updateBy:null,updateTime:null},this.resetForm("form"),this.autoGenFlag=!1},cancel(){const e={path:"/mes/qc/pendinginspect"};this.$tab.closeOpenPage(e)},saveForm(){""==this.form.quantityQualified||void 0==this.form.quantityQualified||0==this.form.quantityQualified||""==this.form.quantityUnqualified||void 0==this.form.quantityUnqualified||0==this.form.quantityUnqualified||this.form.quantityQualified+this.form.quantityUnqualified==this.form.quantityCheck?""!=this.form.quantityQualified&&void 0!=this.form.quantityQualified&&this.form.quantityQualified>this.form.quantityCheck?this.$message.warning("合格数不能大于检测总数！"):""!=this.form.quantityUnqualified&&void 0!=this.form.quantityUnqualified&&this.form.quantityUnqualified>this.form.quantityCheck?this.$message.warning("不合格数不能大于检测总数！"):this.$refs["form"].validate(e=>{e&&(null!=this.form.rqcId?Object(o["e"])(this.form).then(e=>{this.$modal.msgSuccess("修改成功")}):Object(o["a"])(this.form).then(e=>{this.form.rqcId=e.data,this.$modal.msgSuccess("新增成功")}))}):this.$message.warning("合格数与不合格数之和必须等于检测总数！")},handleFinish(){let e=this;null!=this.form.checkResult?this.$refs["form"].validate(t=>{t&&this.$modal.confirm("是否完成检验单编制？【完成后将不能更改】").then((function(){e.form.status="FINISHED",e.saveForm(),e.cancel()}))}):this.$modal.msgError("请选择检测结果！")},handleSelectProduct(){this.$refs.itemSelect.showFlag=!0},onItemSelected(e){void 0!=e&&null!=e&&(this.form.itemId=e.itemId,this.form.itemCode=e.itemCode,this.form.itemName=e.itemName,this.form.specification=e.specification,this.form.unitOfMeasure=e.unitOfMeasure,this.form.unitName=e.unitName)},handleUser2Select(){this.$refs.user2Select.showFlag=!0},onUser2Selected(e){this.form.userId=e.userId,this.form.userName=e.userName,this.form.nickName=e.nickName},handleAutoGenChange(e){e?Object(u["c"])("QC_RQC_CODE").then(e=>{this.form.rqcCode=e}):this.form.rqcCode=null}}},f=m,p=l("2877"),d=Object(p["a"])(f,a,r,!1,null,null,null);t["default"]=d.exports}}]);