(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-be465dda","chunk-0e963352"],{"29cf":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.showFlag?n("el-dialog",{attrs:{title:"设备选择",visible:e.showFlag,modal:!1,width:"80%",center:""},on:{"update:visible":function(t){e.showFlag=t}}},[n("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,size:"small",inline:!0,"label-width":"68px"}},[n("el-form-item",{attrs:{label:"计划编号",prop:"planCode"}},[n("el-input",{attrs:{placeholder:"请输入计划编号",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.planCode,callback:function(t){e.$set(e.queryParams,"planCode",t)},expression:"queryParams.planCode"}})],1),n("el-form-item",{attrs:{label:"计划名称",prop:"planName"}},[n("el-input",{attrs:{placeholder:"请输入计划名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.planName,callback:function(t){e.$set(e.queryParams,"planName",t)},expression:"queryParams.planName"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),n("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.checkplanList},on:{"current-change":e.handleCurrent,"row-dblclick":e.handleRowDbClick}},[n("el-table-column",{attrs:{width:"55",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-radio",{attrs:{label:t.row.planId},on:{change:function(n){return e.handleRowChange(t.row)}},model:{value:e.selectedPlanId,callback:function(t){e.selectedPlanId=t},expression:"selectedPlanId"}},[e._v(e._s(""))])]}}],null,!1,3343453267)}),n("el-table-column",{attrs:{label:"计划编码",align:"center",prop:"planCode"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:checkplan:query"],expression:"['mes:dv:checkplan:query']"}],attrs:{type:"text"},on:{click:function(n){return e.handleView(t.row)}}},[e._v(e._s(t.row.planCode))])]}}],null,!1,1529519676)}),n("el-table-column",{attrs:{label:"计划名称",align:"center",width:"200px",prop:"planName"}}),n("el-table-column",{attrs:{label:"计划类型",align:"center",width:"120px",prop:"planType"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("dict-tag",{attrs:{options:e.dict.type.dv_plan_type,value:t.row.planType}})]}}],null,!1,1542401585)}),n("el-table-column",{attrs:{label:"开始日期",align:"center",prop:"startDate",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.parseTime(t.row.startDate,"{y}-{m}-{d}")))])]}}],null,!1,3859946761)}),n("el-table-column",{attrs:{label:"结束日期",align:"center",prop:"endDate",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.parseTime(t.row.endDate,"{y}-{m}-{d}")))])]}}],null,!1,4090872870)}),n("el-table-column",{attrs:{label:"频率",align:"center",prop:"cycleType",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.cycleCount)),n("dict-tag",{attrs:{options:e.dict.type.mes_cycle_type,value:t.row.cycleType}})]}}],null,!1,1922333513)}),n("el-table-column",{attrs:{label:"状态",align:"center",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("dict-tag",{attrs:{options:e.dict.type.mes_order_status,value:t.row.status}})]}}],null,!1,2866832246)}),n("el-table-column",{attrs:{label:"操作",align:"center",width:"130px","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return["PREPARE"==t.row.status?n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:checkplan:edit"],expression:"['mes:dv:checkplan:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(n){return e.handleUpdate(t.row)}}},[e._v("修改")]):e._e(),"PREPARE"==t.row.status?n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:checkplan:remove"],expression:"['mes:dv:checkplan:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(n){return e.handleDelete(t.row)}}},[e._v("删除")]):e._e(),"FINISHED"==t.row.status?n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:checkplan:edit"],expression:"['mes:dv:checkplan:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(n){return e.handleUpdate(t.row)}}},[e._v("停用")]):e._e()]}}],null,!1,594271702)})],1),n("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.confirmSelect}},[e._v("确 定")]),n("el-button",{on:{click:function(t){e.showFlag=!1}}},[e._v("取 消")])],1)],1):e._e()},a=[],l=n("63b7"),i={name:"CheckplanSelect",dicts:["mes_cycle_type","mes_order_status","dv_plan_type"],props:{planType:{type:String,default:"CHECK"}},data(){return{showFlag:!1,loading:!0,selectedPlanId:void 0,selectedRow:void 0,single:!0,multiple:!0,showSearch:!0,total:0,checkplanList:[],title:"",open:!1,queryParams:{pageNum:1,pageSize:10,planCode:null,planName:null,planType:this.planType,startDate:null,endDate:null,cycleType:null,cycleCount:null,status:"FINISHED"}}},created(){this.getList()},methods:{getList(){this.loading=!0,Object(l["e"])(this.queryParams).then(e=>{this.checkplanList=e.rows,this.total=e.total,this.loading=!1})},handleQuery(){this.queryParams.pageNum=1,this.getList()},resetQuery(){this.resetForm("queryForm"),this.handleQuery()},handleCurrent(e){e&&(this.selectedRow=e)},handleRowDbClick(e){e&&(this.selectedRow=e,this.$emit("onSelected",this.selectedRow),this.showFlag=!1)},handleRowChange(e){e&&(this.selectedRow=e)},confirmSelect(){null!=this.selectedPlanId&&0!=this.selectedPlanId?(this.$emit("onSelected",this.selectedRow),this.showFlag=!1):this.$notify({title:"提示",type:"warning",message:"请至少选择一条数据!"})}}},s=i,o=n("2877"),c=Object(o["a"])(s,r,a,!1,null,null,null);t["a"]=c.exports},5676:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},["view"!=e.optType?n("el-row",{staticClass:"mb8",attrs:{gutter:10}},[n("el-col",{attrs:{span:1.5}},[n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["dv:maintenrecordline:add"],expression:"['dv:maintenrecordline:add']"}],attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:e.handleAdd}},[e._v("新增")])],1),n("el-col",{attrs:{span:1.5}},[n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["dv:maintenrecordline:edit"],expression:"['dv:maintenrecordline:edit']"}],attrs:{type:"success",plain:"",icon:"el-icon-edit",size:"mini",disabled:e.single},on:{click:e.handleUpdate}},[e._v("修改")])],1),n("el-col",{attrs:{span:1.5}},[n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["dv:maintenrecordline:remove"],expression:"['dv:maintenrecordline:remove']"}],attrs:{type:"danger",plain:"",icon:"el-icon-delete",size:"mini",disabled:e.multiple},on:{click:e.handleDelete}},[e._v("删除")])],1),n("right-toolbar",{attrs:{showSearch:e.showSearch},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.getList}})],1):e._e(),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.maintenrecordlineList},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),n("el-table-column",{attrs:{label:"项目名称",align:"center",prop:"subjectName"}}),n("el-table-column",{attrs:{label:"项目内容",align:"center",prop:"subjectContent"}}),n("el-table-column",{attrs:{label:"标准",align:"center",prop:"subjectStandard"}}),n("el-table-column",{attrs:{label:"保养结果",align:"center",prop:"maintenStatus"}}),n("el-table-column",{attrs:{label:"异常描述",align:"center",prop:"maintenResult"}}),"view"!=e.optType?n("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["dv:maintenrecordline:edit"],expression:"['dv:maintenrecordline:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(n){return e.handleUpdate(t.row)}}},[e._v("修改")]),n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["dv:maintenrecordline:remove"],expression:"['dv:maintenrecordline:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(n){return e.handleDelete(t.row)}}},[e._v("删除")])]}}],null,!1,3760872202)}):e._e()],1),n("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),n("el-dialog",{attrs:{title:e.title,visible:e.open,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"计划ID",prop:"recordId"}},[n("el-input",{attrs:{placeholder:"请输入计划ID"},model:{value:e.form.recordId,callback:function(t){e.$set(e.form,"recordId",t)},expression:"form.recordId"}})],1),n("el-form-item",{attrs:{label:"项目ID",prop:"subjectId"}},[n("el-input",{attrs:{placeholder:"请输入项目ID"},model:{value:e.form.subjectId,callback:function(t){e.$set(e.form,"subjectId",t)},expression:"form.subjectId"}})],1),n("el-form-item",{attrs:{label:"项目编码",prop:"subjectCode"}},[n("el-input",{attrs:{placeholder:"请输入项目编码"},model:{value:e.form.subjectCode,callback:function(t){e.$set(e.form,"subjectCode",t)},expression:"form.subjectCode"}})],1),n("el-form-item",{attrs:{label:"项目名称",prop:"subjectName"}},[n("el-input",{attrs:{placeholder:"请输入项目名称"},model:{value:e.form.subjectName,callback:function(t){e.$set(e.form,"subjectName",t)},expression:"form.subjectName"}})],1),n("el-form-item",{attrs:{label:"项目类型",prop:"subjectType"}},[n("el-select",{attrs:{placeholder:"请选择项目类型"},model:{value:e.form.subjectType,callback:function(t){e.$set(e.form,"subjectType",t)},expression:"form.subjectType"}},[n("el-option",{attrs:{label:"请选择字典生成",value:""}})],1)],1),n("el-form-item",{attrs:{label:"项目内容"}},[n("editor",{attrs:{"min-height":192},model:{value:e.form.subjectContent,callback:function(t){e.$set(e.form,"subjectContent",t)},expression:"form.subjectContent"}})],1),n("el-form-item",{attrs:{label:"标准",prop:"subjectStandard"}},[n("el-input",{attrs:{placeholder:"请输入标准"},model:{value:e.form.subjectStandard,callback:function(t){e.$set(e.form,"subjectStandard",t)},expression:"form.subjectStandard"}})],1),n("el-form-item",{attrs:{label:"保养结果"}},[n("el-radio-group",{model:{value:e.form.maintenStatus,callback:function(t){e.$set(e.form,"maintenStatus",t)},expression:"form.maintenStatus"}},[n("el-radio",{attrs:{label:"1"}},[e._v("请选择字典生成")])],1)],1),n("el-form-item",{attrs:{label:"异常描述",prop:"maintenResult"}},[n("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.form.maintenResult,callback:function(t){e.$set(e.form,"maintenResult",t)},expression:"form.maintenResult"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),n("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},a=[],l=(n("e9f5"),n("ab43"),n("b775"));function i(e){return Object(l["a"])({url:"/mes/dv/maintenrecordline/list",method:"get",params:e})}function s(e){return Object(l["a"])({url:"/mes/dv/maintenrecordline/"+e,method:"get"})}function o(e){return Object(l["a"])({url:"/mes/dv/maintenrecordline",method:"post",data:e})}function c(e){return Object(l["a"])({url:"/mes/dv/maintenrecordline",method:"put",data:e})}function u(e){return Object(l["a"])({url:"/mes/dv/maintenrecordline/"+e,method:"delete"})}var d=n("8063"),m={name:"Maintenrecordline",props:{optType:null,recordId:null},dicts:["dv_cm_result_status"],components:{DvSubjectSelect:d["a"]},data(){return{loading:!0,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,maintenrecordlineList:[],title:"",open:!1,queryParams:{pageNum:1,pageSize:10,recordId:null,subjectId:null,subjectCode:null,subjectName:null,subjectType:null,subjectContent:null,subjectStandard:null,maintenStatus:null,maintenResult:null},form:{},rules:{recordId:[{required:!0,message:"计划ID不能为空",trigger:"blur"}],subjectId:[{required:!0,message:"项目ID不能为空",trigger:"blur"}],subjectCode:[{required:!0,message:"项目编码不能为空",trigger:"blur"}],subjectContent:[{required:!0,message:"项目内容不能为空",trigger:"blur"}],maintenStatus:[{required:!0,message:"保养结果不能为空",trigger:"blur"}]}}},created(){this.getList()},methods:{getList(){this.loading=!0,i(this.queryParams).then(e=>{this.maintenrecordlineList=e.rows,this.total=e.total,this.loading=!1})},cancel(){this.open=!1,this.reset()},reset(){this.form={lineId:null,recordId:null,subjectId:null,subjectCode:null,subjectName:null,subjectType:null,subjectContent:null,subjectStandard:null,maintenStatus:"0",maintenResult:null,attr1:null,attr2:null,attr3:null,attr4:null,createBy:null,createTime:null,updateBy:null,updateTime:null},this.resetForm("form")},handleQuery(){this.queryParams.pageNum=1,this.getList()},resetQuery(){this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange(e){this.ids=e.map(e=>e.lineId),this.single=1!==e.length,this.multiple=!e.length},handleAdd(){this.reset(),this.open=!0,this.title="添加设备保养记录行"},handleUpdate(e){this.reset();const t=e.lineId||this.ids;s(t).then(e=>{this.form=e.data,this.open=!0,this.title="修改设备保养记录行"})},submitForm(){this.$refs["form"].validate(e=>{e&&(null!=this.form.lineId?c(this.form).then(e=>{this.$modal.msgSuccess("修改成功"),this.open=!1,this.getList()}):o(this.form).then(e=>{this.$modal.msgSuccess("新增成功"),this.open=!1,this.getList()}))})},handleDelete(e){const t=e.lineId||this.ids;this.$modal.confirm('是否确认删除设备保养记录行编号为"'+t+'"的数据项？').then((function(){return u(t)})).then(()=>{this.getList(),this.$modal.msgSuccess("删除成功")}).catch(()=>{})},handleExport(){this.download("dv/maintenrecordline/export",{...this.queryParams},`maintenrecordline_${(new Date).getTime()}.xlsx`)}}},p=m,h=n("2877"),f=Object(h["a"])(p,r,a,!1,null,null,null);t["default"]=f.exports},"63b7":function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c}));var r=n("b775");function a(e){return Object(r["a"])({url:"/mes/dv/checkplan/list",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/mes/dv/checkplan/"+e,method:"get"})}function i(e){return Object(r["a"])({url:"/mes/dv/checkplan",method:"post",data:e})}function s(e){return Object(r["a"])({url:"/mes/dv/checkplan",method:"put",data:e})}function o(e){return Object(r["a"])({url:"/mes/dv/checkplan/"+e,method:"delete"})}function c(e){return Object(r["a"])({url:"/mes/dv/checkplan/getCheckPlan",method:"get",params:e})}},"66e4":function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return o}));var r=n("b775");function a(e){return Object(r["a"])({url:"/mes/dv/machinery/list",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/mes/dv/machinery/"+e,method:"get"})}function i(e){return Object(r["a"])({url:"/mes/dv/machinery",method:"post",data:e})}function s(e){return Object(r["a"])({url:"/mes/dv/machinery",method:"put",data:e})}function o(e){return Object(r["a"])({url:"/mes/dv/machinery/"+e,method:"delete"})}},"995c":function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return o}));var r=n("b775");function a(e){return Object(r["a"])({url:"/mes/dv/dvsubject/list",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/mes/dv/dvsubject/"+e,method:"get"})}function i(e){return Object(r["a"])({url:"/mes/dv/dvsubject",method:"post",data:e})}function s(e){return Object(r["a"])({url:"/mes/dv/dvsubject",method:"put",data:e})}function o(e){return Object(r["a"])({url:"/mes/dv/dvsubject/"+e,method:"delete"})}},a15c:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return o}));var r=n("b775");function a(e){return Object(r["a"])({url:"/mes/dv/machinerytype/list",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/mes/dv/machinerytype/"+e,method:"get"})}function i(e){return Object(r["a"])({url:"/mes/dv/machinerytype",method:"post",data:e})}function s(e){return Object(r["a"])({url:"/mes/dv/machinerytype",method:"put",data:e})}function o(e){return Object(r["a"])({url:"/mes/dv/machinerytype/"+e,method:"delete"})}},b9ff:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,size:"small",inline:!0,"label-width":"68px"}},[n("el-form-item",{attrs:{label:"计划名称",prop:"planName"}},[n("el-input",{attrs:{placeholder:"请输入计划名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.planName,callback:function(t){e.$set(e.queryParams,"planName",t)},expression:"queryParams.planName"}})],1),n("el-form-item",{attrs:{label:"设备编码",prop:"machineryCode"}},[n("el-input",{attrs:{placeholder:"请输入设备编码",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.machineryCode,callback:function(t){e.$set(e.queryParams,"machineryCode",t)},expression:"queryParams.machineryCode"}})],1),n("el-form-item",{attrs:{label:"设备名称",prop:"machineryName"}},[n("el-input",{attrs:{placeholder:"请输入设备名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.machineryName,callback:function(t){e.$set(e.queryParams,"machineryName",t)},expression:"queryParams.machineryName"}})],1),n("el-form-item",{attrs:{label:"保养人",prop:"nickName"}},[n("el-input",{attrs:{placeholder:"请输入名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.nickName,callback:function(t){e.$set(e.queryParams,"nickName",t)},expression:"queryParams.nickName"}})],1),n("el-form-item",{attrs:{label:"保养时间",prop:"maintenTime"}},[n("el-date-picker",{attrs:{clearable:"",type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择保养时间"},model:{value:e.queryParams.maintenTime,callback:function(t){e.$set(e.queryParams,"maintenTime",t)},expression:"queryParams.maintenTime"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),n("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),n("el-row",{staticClass:"mb8",attrs:{gutter:10}},[n("el-col",{attrs:{span:1.5}},[n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:maintenrecord:add"],expression:"['mes:dv:maintenrecord:add']"}],attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:e.handleAdd}},[e._v("新增")])],1),n("el-col",{attrs:{span:1.5}},[n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:maintenrecord:edit"],expression:"['mes:dv:maintenrecord:edit']"}],attrs:{type:"success",plain:"",icon:"el-icon-edit",size:"mini",disabled:e.single},on:{click:e.handleUpdate}},[e._v("修改")])],1),n("el-col",{attrs:{span:1.5}},[n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:maintenrecord:remove"],expression:"['mes:dv:maintenrecord:remove']"}],attrs:{type:"danger",plain:"",icon:"el-icon-delete",size:"mini",disabled:e.multiple},on:{click:e.handleDelete}},[e._v("删除")])],1),n("right-toolbar",{attrs:{showSearch:e.showSearch},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.getList}})],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.maintenrecordList},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),n("el-table-column",{attrs:{label:"设备编码",align:"center",prop:"machineryCode"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["mes:dv:maintenrecord:query"],expression:"['mes:dv:maintenrecord:query']"}],attrs:{type:"text"},on:{click:function(n){return e.handleView(t.row)}}},[e._v(e._s(t.row.machineryCode))])]}}])}),n("el-table-column",{attrs:{label:"设备名称",align:"center",prop:"machineryName"}}),n("el-table-column",{attrs:{label:"品牌",align:"center",prop:"machineryBrand"}}),n("el-table-column",{attrs:{label:"规格型号",align:"center",prop:"machinerySpec"}}),n("el-table-column",{attrs:{label:"计划名称",align:"center",prop:"planName"}}),n("el-table-column",{attrs:{label:"保养时间",align:"center",prop:"maintenTime",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.parseTime(t.row.maintenTime,"{y}-{m}-{d} {h}:{i}:{s}")))])]}}])}),n("el-table-column",{attrs:{label:"保养人",align:"center",prop:"nickName"}}),n("el-table-column",{attrs:{label:"状态",align:"center",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("dict-tag",{attrs:{options:e.dict.type.mes_order_status,value:t.row.status}})]}}])}),n("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return["PREPARE"===t.row.status?n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["dv:maintenrecord:edit"],expression:"['dv:maintenrecord:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(n){return e.handleUpdate(t.row)}}},[e._v("修改")]):e._e(),"PREPARE"===t.row.status?n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["dv:maintenrecord:remove"],expression:"['dv:maintenrecord:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(n){return e.handleDelete(t.row)}}},[e._v("删除")]):e._e()]}}])})],1),n("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),n("el-dialog",{attrs:{title:e.title,visible:e.open,width:"960px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[n("el-row",[n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"设备编码",prop:"machineryCode"}},[n("el-input",{attrs:{placeholder:"请选择设备"},model:{value:e.form.machineryCode,callback:function(t){e.$set(e.form,"machineryCode",t)},expression:"form.machineryCode"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSelectMachinery},slot:"append"})],1)],1),n("MachinerySelectSingle",{ref:"machinerySelect",on:{onSelected:e.onMachineryAdd}})],1),n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"设备名称",prop:"machineryName"}},[n("el-input",{attrs:{readonly:"readonly",placeholder:"请选择设备"},model:{value:e.form.machineryName,callback:function(t){e.$set(e.form,"machineryName",t)},expression:"form.machineryName"}})],1)],1),n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"品牌",prop:"machineryBrand"}},[n("el-input",{attrs:{readonly:"readonly",placeholder:"请选择设备"},model:{value:e.form.machineryBrand,callback:function(t){e.$set(e.form,"machineryBrand",t)},expression:"form.machineryBrand"}})],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"规格型号",prop:"machinerySpec"}},[n("el-input",{attrs:{readonly:"readonly",type:"textarea",placeholder:"请选择设备"},model:{value:e.form.machinerySpec,callback:function(t){e.$set(e.form,"machinerySpec",t)},expression:"form.machinerySpec"}})],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"保养计划",prop:"planName"}},[n("el-input",{attrs:{placeholder:"请选择设备保养计划"},model:{value:e.form.planName,callback:function(t){e.$set(e.form,"planName",t)},expression:"form.planName"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSelectPlan},slot:"append"})],1)],1),n("CheckplanSelect",{ref:"checkplanSelect",attrs:{planType:"MAINTEN"},on:{onSelected:e.onPlanAdd}})],1),n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"保养人",prop:"nickName"}},[n("el-input",{attrs:{placeholder:"请选择保养人"},model:{value:e.form.nickName,callback:function(t){e.$set(e.form,"nickName",t)},expression:"form.nickName"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleUserSelect},slot:"append"})],1)],1),n("UserSingleSelect",{ref:"userSelect",on:{onSelected:e.onUserSelected}})],1),n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"保养时间",prop:"maintenTime"}},[n("el-date-picker",{attrs:{clearable:"",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择保养时间"},model:{value:e.form.maintenTime,callback:function(t){e.$set(e.form,"maintenTime",t)},expression:"form.maintenTime"}})],1)],1)],1),n("el-row",[n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"备注",prop:"remark"}},[n("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1)],1),null!=e.form.recordId?n("el-divider",{attrs:{"content-position":"center"}},[e._v("保养项目")]):e._e(),null!=e.form.recordId?n("el-card",{staticClass:"box-card",attrs:{shadow:"always"}},[n("MaintenRecordLine",{ref:"maintenRecordLine",attrs:{optType:e.optType,recordId:e.form.recordId}})],1):e._e(),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["view"==e.optType||"PREPARE"!=e.form.status?n("el-button",{attrs:{type:"primary"},on:{click:e.cancel}},[e._v("返 回")]):e._e(),"view"!==e.optType&&"PREPARE"==e.form.status?n("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("保 存")]):e._e(),"view"!==e.optType&&"PREPARE"==e.form.status?n("el-button",{attrs:{type:"success"},on:{click:e.handleFinish}},[e._v("提 交")]):e._e(),n("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},a=[],l=(n("e9f5"),n("ab43"),n("b775"));function i(e){return Object(l["a"])({url:"/mes/dv/maintenrecord/list",method:"get",params:e})}function s(e){return Object(l["a"])({url:"/mes/dv/maintenrecord/"+e,method:"get"})}function o(e){return Object(l["a"])({url:"/mes/dv/maintenrecord",method:"post",data:e})}function c(e){return Object(l["a"])({url:"/mes/dv/maintenrecord",method:"put",data:e})}function u(e){return Object(l["a"])({url:"/mes/dv/maintenrecord/"+e,method:"delete"})}var d=n("7dc7"),m=n("29cf"),p=n("8198"),h=n("5676"),f={name:"Maintenrecord",dicts:["mes_order_status"],components:{MachinerySelectSingle:d["a"],CheckplanSelect:m["a"],UserSingleSelect:p["a"],MaintenRecordLine:h["default"]},data(){return{optType:null,loading:!0,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,maintenrecordList:[],title:"",open:!1,queryParams:{pageNum:1,pageSize:10,planId:null,planCode:null,planName:null,planType:null,machineryId:null,machineryCode:null,machineryName:null,machineryBrand:null,machinerySpec:null,maintenTime:null,userId:null,userName:null,nickName:null,status:null},form:{},rules:{machineryId:[{required:!0,message:"设备ID不能为空",trigger:"blur"}],machineryCode:[{required:!0,message:"设备编码不能为空",trigger:"blur"}],machineryName:[{required:!0,message:"设备名称不能为空",trigger:"blur"}],maintenTime:[{required:!0,message:"保养时间不能为空",trigger:"blur"}]}}},created(){this.getList()},methods:{getList(){this.loading=!0,i(this.queryParams).then(e=>{this.maintenrecordList=e.rows,this.total=e.total,this.loading=!1})},cancel(){this.open=!1,this.reset()},reset(){this.form={recordId:null,planId:null,planCode:null,planName:null,planType:null,machineryId:null,machineryCode:null,machineryName:null,machineryBrand:null,machinerySpec:null,maintenTime:null,userId:null,userName:null,nickName:null,status:"PREPARE",remark:null,attr1:null,attr2:null,attr3:null,attr4:null,createBy:null,createTime:null,updateBy:null,updateTime:null},this.form.userId=this.$store.state.user.id,this.form.nickName=this.$store.state.user.nick,this.form.userName=this.$store.state.user.name,this.resetForm("form")},handleQuery(){this.queryParams.pageNum=1,this.getList()},resetQuery(){this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange(e){this.ids=e.map(e=>e.recordId),this.single=1!==e.length,this.multiple=!e.length},handleAdd(){this.reset(),this.open=!0,this.title="添加设备保养记录",this.optType="add"},handleUpdate(e){this.reset();const t=e.recordId||this.ids;s(t).then(e=>{this.form=e.data,this.open=!0,this.title="修改设备保养记录",this.optType="edit"})},handleView(e){this.reset();const t=e.recordId||this.ids;s(t).then(e=>{this.form=e.data,this.open=!0,this.title="查看设备保养记录",this.optType="view"})},submitForm(){this.$refs["form"].validate(e=>{e&&(null!=this.form.recordId?c(this.form).then(e=>{this.$modal.msgSuccess("修改成功"),this.open=!1,this.getList()}):o(this.form).then(e=>{this.$modal.msgSuccess("新增成功"),this.open=!1,this.getList()}))})},handleFinish(){null!=this.form.recordId&&"PREPARE"==this.form.status&&(this.form.status="FINISHED",c(this.form).then(e=>{this.$modal.msgSuccess("已提交"),this.open=!1,this.getList()},e=>{this.form.status="PREPARE"}))},handleDelete(e){const t=e.recordId||this.ids;this.$modal.confirm('是否确认删除设备保养记录编号为"'+t+'"的数据项？').then((function(){return u(t)})).then(()=>{this.getList(),this.$modal.msgSuccess("删除成功")}).catch(()=>{})},handleSelectMachinery(){this.$refs.machinerySelect.showFlag=!0},onMachineryAdd(e){null!=e&&void 0!=e&&(this.form.machineryId=e.machineryId,this.form.machineryCode=e.machineryCode,this.form.machineryName=e.machineryName,this.form.machineryBrand=e.machineryBrand,this.form.machinerySpec=e.machinerySpec)},handleSelectPlan(){this.$refs.checkplanSelect.showFlag=!0},onPlanAdd(e){null!=e&&void 0!=e&&(this.form.planId=e.planId,this.form.planCode=e.planCode,this.form.planName=e.planName,this.form.planType=e.planType)},handleUserSelect(){this.$refs.userSelect.showFlag=!0},onUserSelected(e){this.form.userId=e.userId,this.form.nickName=e.nickName,this.form.userName=e.userName}}},y=f,b=n("2877"),v=Object(b["a"])(y,r,a,!1,null,null,null);t["default"]=v.exports},c0c7:function(e,t,n){"use strict";n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"j",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"f",(function(){return m})),n.d(t,"k",(function(){return p})),n.d(t,"l",(function(){return h})),n.d(t,"m",(function(){return f})),n.d(t,"d",(function(){return y})),n.d(t,"i",(function(){return b}));var r=n("b775"),a=n("c38a");function l(e){return Object(r["a"])({url:"/system/user/list",method:"get",params:e})}function i(e){return Object(r["a"])({url:"/system/user/"+Object(a["e"])(e),method:"get"})}function s(e){return Object(r["a"])({url:"/system/user",method:"post",data:e})}function o(e){return Object(r["a"])({url:"/system/user",method:"put",data:e})}function c(e){return Object(r["a"])({url:"/system/user/"+e,method:"delete"})}function u(e,t){const n={userId:e,password:t};return Object(r["a"])({url:"/system/user/resetPwd",method:"put",data:n})}function d(e,t){const n={userId:e,status:t};return Object(r["a"])({url:"/system/user/changeStatus",method:"put",data:n})}function m(){return Object(r["a"])({url:"/system/user/profile",method:"get"})}function p(e){return Object(r["a"])({url:"/system/user/profile",method:"put",data:e})}function h(e,t){const n={oldPassword:e,newPassword:t};return Object(r["a"])({url:"/system/user/profile/updatePwd",method:"put",params:n})}function f(e){return Object(r["a"])({url:"/system/user/profile/avatar",method:"post",data:e})}function y(e){return Object(r["a"])({url:"/system/user/authRole/"+e,method:"get"})}function b(e){return Object(r["a"])({url:"/system/user/authRole",method:"put",params:e})}},dfb9:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n("b775");function a(e){return Object(r["a"])({url:"/mes/md/workshop/list",method:"get",params:e})}function l(){return Object(r["a"])({url:"/mes/md/workshop/listAll",method:"get"})}function i(e){return Object(r["a"])({url:"/mes/md/workshop/"+e,method:"get"})}function s(e){return Object(r["a"])({url:"/mes/md/workshop",method:"post",data:e})}function o(e){return Object(r["a"])({url:"/mes/md/workshop",method:"put",data:e})}function c(e){return Object(r["a"])({url:"/mes/md/workshop/"+e,method:"delete"})}},fcb7:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return i})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n("b775");function a(e){return Object(r["a"])({url:"/system/dept/list",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/system/dept/list/exclude/"+e,method:"get"})}function i(e){return Object(r["a"])({url:"/system/dept/"+e,method:"get"})}function s(){return Object(r["a"])({url:"/system/dept/treeselect",method:"get"})}function o(e){return Object(r["a"])({url:"/system/dept/roleDeptTreeselect/"+e,method:"get"})}function c(e){return Object(r["a"])({url:"/system/dept",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/system/dept",method:"put",data:e})}function d(e){return Object(r["a"])({url:"/system/dept/"+e,method:"delete"})}}}]);